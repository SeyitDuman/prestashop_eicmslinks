(function (tinymce) {
    tinymce.create('tinymce.plugins.EiCmsLinksPlugin', {
        init: function (ed, url) {
 
            ed.addCommand('mceCmsLinks', function () {
                ed.windowManager.open({
                    title: 'Ajouter un lien dynamique',
                    file: url + '/eicmslinks.php?eicmslinks_sel=' + encodeURIComponent(tinymce.activeEditor.selection.getContent({format: 'text'})),
                    width: 650,
                    height: 400,
                    inline: 1
                }, {
                    plugin_url: url
                });

            });
            ed.addButton('eicmslinks', {
                title: 'Ajouter un lien dynamique',
                cmd: 'mceCmsLinks',
                image: url + '/img/eicmslinks.gif'
            });
        },
        getInfo: function () {
            return {
                longname: 'Ei Cms Links',
                author: 'dev@europe-internet.net',
                authorurl: 'http://www.h-hennes.fr/blog/',
                infourl: 'http://www.h-hennes.fr/blog/',
                version: tinymce.majorVersion + "." + tinymce.minorVersion
            };
        }
    });
    tinymce.PluginManager.add('eicmslinks', tinymce.plugins.EiCmsLinksPlugin);
})(tinymce);